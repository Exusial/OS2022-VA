### 虚存&地址空间

1.linux系统有许多管理地址空间的工具。请自行学习linux系统的free指令，并使用free指令展示系统的空闲内存。

2.linux系统还有pmap工具用于查看进程的内存信息。请学习pmap指令的用法，并随意指定几个不同进程使用pmap来查看它们对应的地址空间。请比较它们的输出和我们课程上介绍的简单内存空间模型的区别。

3.请使用c语言写一个简单的程序来探索地址空间。它的功能是静态分配指定大小的内存并依次访问它们，并需要接受一个参数作为该内存的大小。分别针对不同的分配大小，使用free指令和pmap指令来查看程序运行是否符合你预期的情况。

4.编写一个含有malloc动态分配内存的c程序，针对访问越界、未释放内存以及未分配内存就访问等情况选择一个或多个，在http://valgrind.org/downloads/current.html安装内存检查工具valgrind，并使用其查看bug的结果和你的设计是否符合。

5.下载paging-linear-translate.py文件。它针对的是最简单的线性映射情况。请进行如下操作。

- 使用下列作为参数，探究增大地址空间页表占比之后的会发生什么。

  ![image-20220120162511479](C:\Users\22478\AppData\Roaming\Typora\typora-user-images\image-20220120162511479.png)

- 请更换程序之中的随机种子，并尝试下列非常规的参数。那一组参数对于该程序而言是不现实的？

  ![image-20220120162525583](C:\Users\22478\AppData\Roaming\Typora\typora-user-images\image-20220120162525583.png)

- 请探究什么时候程序就失效了，比如分配的地址空间大于实际空间。并记录这些参数下程序的表现。

6.请计算如果使用单级页表对4GB物理地址空间进行线性映射，页面大小为4KB，PTE大小为4byte。请计算大概需要多少个页面以及它们所占的大小。请描述为什么在现代计算机中面对这种占用仍然需要设计新的策略来避免过大内存的占用？

7.下载paging-multilevel-translate.py文件来模拟多级页表的功能，并完成如下的问题。

- 请指出使用2级和3级页表分别需要几个寄存器来实现完整的地址查找过程？
- 设置模拟页表文件的随机种子分别为0，1，2以及-c flag，分别指出需要多少内存引用来完成1次查找？
- 请你指出，引入虚存机制之后cache的hit/miss情况分别有什么变化。

